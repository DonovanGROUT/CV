document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".nav-link"),t=document.querySelectorAll(".dropdown-item"),o=document.querySelectorAll(".progress-bar"),n=document.querySelectorAll(".timeline-item"),r=document.querySelector("#phone"),l=document.querySelector("form");$(".carousel.owl-carousel").owlCarousel({margin:10,loop:!0,autoplay:!0,autoplayTimeout:3e3,autoplayHoverPause:!0,dots:!0,nav:!1,navText:["←","→"],onInitialized:function(e){$(".owl-dot").each((function(e){$(this).attr("aria-label","Projet "+(e+1))})),$(".custom-owl-prev").attr("aria-label","Projet précédent"),$(".custom-owl-next").attr("aria-label","Projet suivant")},onChanged:function(e){h()},responsive:{0:{items:1},800:{items:2},1200:{items:3}}}),$(".custom-owl-next").click((function(){$(".carousel").trigger("next.owl.carousel")})),$(".custom-owl-prev").click((function(){$(".carousel").trigger("prev.owl.carousel")}));const a=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.classList.contains("progress-bar")?e.target.style.width=e.target.getAttribute("data-width"):e.target.classList.contains("timeline-item")&&e.target.classList.add("in-view"))}))}),{threshold:.1});o.forEach((e=>a.observe(e))),n.forEach((e=>a.observe(e)));const c=(e,t)=>{e.forEach((e=>{e.classList.toggle("active",e.getAttribute("href").substring(1)===t)}))},i=o=>{const n=o.currentTarget.getAttribute("href");if(!n.startsWith("#"))return;o.preventDefault();const r=n.substring(1),l=document.getElementById(r);l&&(window.scrollTo({top:l.offsetTop-document.querySelector(".navbar").offsetHeight,behavior:"smooth"}),c(e,r),c(t,r))};e.forEach((e=>e.addEventListener("click",i))),t.forEach((e=>e.addEventListener("click",i)));const s=document.querySelectorAll(".view-label-btn");let u=null;"ontouchstart"in document.documentElement?s.forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation();const o=e.closest(".timeline-panel")||e.closest(".card"),n=o.querySelector(".timeline-body")||o.querySelector(".card-label");u&&u!==e&&function(){if(u){const e=u.closest(".timeline-panel")||u.closest(".card");(e.querySelector(".timeline-body")||e.querySelector(".card-label")).style.display="none",u.textContent="Voir les détails",u=null}}(),"block"===n.style.display?(n.style.display="none",e.textContent="Voir les détails"):(n.style.display="block",e.textContent="Cacher les détails",u=e)}))})):s.forEach((e=>{const t=e.closest(".timeline-panel")||e.closest(".card"),o=t.querySelector(".timeline-body")||t.querySelector(".card-label");t.addEventListener("mouseenter",(()=>{o.style.display="block"})),t.addEventListener("mouseleave",(()=>{o.style.display="none"}))}));const d=window.intlTelInput(r,{initialCountry:"auto",geoIpLookup(e){fetch("https://ipinfo.io?token=2ee5851481d61d").then((e=>e.json())).then((t=>{const o=t.country?t.country.toLowerCase():"fr";e(o),d.setCountry(o)})).catch((()=>{e("fr"),d.setCountry("fr")}))},utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.13/js/utils.js"});if(r.addEventListener("countrychange",(()=>{const e=d.getSelectedCountryData().maxNumberLength;r.maxLength=e||15})),l.addEventListener("submit",(e=>{const t=d.getNumber();if(r.value=t,"127.0.0.1"===window.location.hostname||"localhost"===window.location.hostname){e.preventDefault();const t=document.getElementById("rgpd-consent");if(t&&!t.checked)return void alert("Veuillez accepter les conditions de confidentialité pour continuer.");localStorage.removeItem("formData"),window.location.href="remerciement-formulaire.html"}})),l){var m=JSON.parse(localStorage.getItem("formData"));if(m)for(var f in m){var y=l.querySelector('[name="'+f+'"]');y&&(y.value=m[f])}l.addEventListener("input",(function(){var e=new FormData(l),t={};e.forEach(((e,o)=>{t[o]=e})),localStorage.setItem("formData",JSON.stringify(t))})),l.addEventListener("submit",(function(){localStorage.removeItem("formData")}))}function h(){const e="dark"===document.documentElement.getAttribute("data-theme");document.querySelectorAll(".owl-dot span").forEach((t=>{t.style.backgroundColor=e?"#3D63DD":"#FF8552"}))}h()}));